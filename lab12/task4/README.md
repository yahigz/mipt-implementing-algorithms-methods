Алгоритм поддерживает вычисления только для квадратных матриц (то есть прямоугольные должны быть дополнены до квадратных нулями).